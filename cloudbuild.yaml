{
  "steps": [
    {
      "name": "gcr.io/cloud-builders/docker",
      "args": ["build", "-t", "gcr.io/mukeshbothers/core-web:latest", "."],
      "dir": "./web"
    },
    {
      "name": "gcr.io/cloud-builders/docker",
      "args": ["push", "gcr.io/mukeshbothers/core-web:latest"]
    },
    {
      "name": "gcr.io/cloud-builders/docker",
      "args": ["build", "-t", "gcr.io/mukeshbothers/core-nginx:latest", "./nginx"]
    },
    {
      "name": "gcr.io/cloud-builders/docker",
      "args": ["push", "gcr.io/mukeshbothers/core-nginx:latest"]
    },
    {
      "name": "gcr.io/cloud-builders/kubectl",
      "args": ["apply", "-f", "deployment.yaml"],
      "env": [
        "CLOUDSDK_COMPUTE_REGION=asia-south1",
        "CLOUDSDK_COMPUTE_ZONE=asia-south1-a",
        "CLOUDSDK_CONTAINER_CLUSTER=mukesh",
        "CLOUDSDK_CORE_PROJECT=mukeshbothers"
      ]
    }
  ],
  "images": [
    "gcr.io/mukeshbothers/core-web:latest",
    "gcr.io/mukeshbothers/core-nginx:latest"
  ],
  "options": {
    "logging": {
      "default_logs_bucket_behavior": "REGIONAL_USER_OWNED_BUCKET"
    }
  }
}
